# Coordinate Extractor Service

HTTP-сервис для извлечения географических координат из текста с поддержкой множества форматов.

## Поддерживаемые форматы

1. `12.2112 -32.434` - Десятичные градусы
2. `N12.2112 W32.434` - С указанием полушарий
3. `34-24N 124-49W` - Градусы-минуты
4. `5401N 15531W` - Компактный формат DDMM
5. `N405229 E087182` - Компактный формат DDMMSS
6. `51°12.32'S 32°34.43'E` - Градусы и десятичные минуты
7. `51°12'32.212"S 32°34'23.1232"E` - Полный DMS
8. `51°12.32' с.ш. 32°34.43' в.д.` - Русские обозначения
9. `55,755831°, 37,617673°` - С запятыми
10. И другие варианты...

## Сборка

### Требования

- C++17 совместимый компилятор (g++, clang++)
- make
- Linux/macOS/Windows

### Компиляция

```bash
# Сборка
make
```
## Запуск

```bash
# Запуск на порту 8080 (по умолчанию)
make run

# Или напрямую
./coord_extractor

# Запуск на другом порту
./coord_extractor 9000
# Или через make
make run-port PORT=9000
```

## API

### POST /extract

Извлекает координаты из текста.

**Request:**
```
POST /extract HTTP/1.1
Content-Type: text/plain

Ваш текст с координатами, например:
Точка A: 55.755831° 37.617673°
Точка B: N40.7128 W74.0060
```

**Response:**
```json
{
  "geometry_type": "points",
  "coordinates_count": 2,
  "coordinates": [
    {
      "latitude": 55.755831,
      "longitude": 37.617673,
      "original_format": "55.755831° 37.617673°",
      "context": "Точка A: 55.755831° 37.617673°",
      "name": "Точка A"
    },
    {
      "latitude": 40.712800,
      "longitude": -74.006000,
      "original_format": "N40.7128 W74.0060",
      "context": "Точка B: N40.7128 W74.0060",
      "name": "Точка B"
    }
  ],
  "message": "Successfully extracted 2 coordinate(s)"
}
```

### GET /

Возвращает простую HTML-форму для тестирования.

## Типы геометрии

- **points** - одиночные точки
- **line** - последовательность точек на одной линии
- **polygon** - замкнутый полигон

## Архитектура

Проект разбит на модули:

- **Structs.h** - Базовые структуры данных
- **Validator.h** - Валидация координат
- **Parser.h** - Парсинг различных форматов
- **Extractor.h** - Извлечение координат из текста
- **GeometryAnalyzer.h** - Анализ типа геометрии
- **JsonSerializer.h** - Сериализация в JSON
- **HttpServer.h** - HTTP сервер
- **main.cpp** - Главный файл приложения

## Особенности реализации

1. **Модульность** - каждый компонент отвечает за свою задачу
2. **Валидация** - проверка корректности координат (широта: -90..90, долгота: -180..180)
3. **Обработка ошибок** - некорректные координаты игнорируются
4. **Контекст** - извлечение предложения с координатой
5. **Названия** - автоматическое определение названий точек
6. **Кроссплатформенность** - работает на Linux, macOS, Windows

## Тестирование

```bash
# Быстрый тест
echo "Координаты: 55.7558, 37.6173" | \
  curl -X POST http://localhost:8080/extract -d @-

# Тест из примера
cat > test.txt << EOF
Экспедиция в Арктику
Точка высадки: 76°00'00"N 51°30'00"E
Лежбище моржей: N80.4551 E54.7893
EOF

curl -X POST http://localhost:8080/extract --data-binary @test.txt

# Веб-интерфейс
open http://localhost:8080  # macOS
xdg-open http://localhost:8080  # Linux
```

## Ограничения

- Максимальный размер входного текста: 1 МБ
- Координаты должны быть валидны (lat: -90..90, lon: -180..180)
- Сервер однопоточный (для многопоточности нужна доработка)

## Очистка

```bash
make clean
```